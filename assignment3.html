<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>assignment3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="assignment3_files/libs/clipboard/clipboard.min.js"></script>
<script src="assignment3_files/libs/quarto-html/quarto.js"></script>
<script src="assignment3_files/libs/quarto-html/popper.min.js"></script>
<script src="assignment3_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="assignment3_files/libs/quarto-html/anchor.min.js"></script>
<link href="assignment3_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="assignment3_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="assignment3_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="assignment3_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="assignment3_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<section id="assignment-3-busi-520-python-for-business-research-jones-graduate-school-of-business-rice-university" class="level2">
<h2 class="anchored" data-anchor-id="assignment-3-busi-520-python-for-business-research-jones-graduate-school-of-business-rice-university">Assignment 3<br>BUSI 520: Python for Business Research<br>Jones Graduate School of Business<br>Rice University<br></h2>
<p>Read the datasets announcements.csv and crsp.csv into dataframes. Each row of announcements.csv is a (stock, quarter) pair. Each row of crsp.csv is a (stock, day) pair. Complete the following.</p>
<ol type="1">
<li><p>How many stock-days are there in the crsp dataframe? How many stock-quarters are there in announcements.csv?</p></li>
<li><p>How many unique permnos are there in the announcements dataframe? Hint: there is a unique method. Use len also.</p></li>
<li><p>Create a “quarter” column in the announcements dataframe based on the fiscal_period column.</p></li>
<li><p>Create a “quarter” column in the crsp dataframe based on the date column.</p></li>
<li><p>Extract the last day of each quarter for each permno in the crsp dataframe. Hint: use groupby and .last().</p></li>
<li><p>Change the name of the ‘date’ column in the announcements dataframe to ‘ea_date’. This is the date of the firm’s quarterly earnings announcement. Hint: pass a dictionary as columns = {‘old name’: ‘new name’} to the rename method.</p></li>
<li><p>Merge the reduced crsp dataframe with the announcement dataframe, matching on [‘permno’, ‘quarter’]. Hint: permno and quarter will form the index of the reduced crsp dataframe after grouping. You will need to reset the index or use left_on=… and right_index=True, or right_on=… and left_index=True in the merge.</p></li>
<li><p>Filter the merged dataframe to keep only rows satisfying price&gt;=5, me&gt;=50000, and shrcd in [10, 11]. Save this as a csv file and submit on Canvas. Use the filtered dataframe to answer all remaining questions.</p></li>
<li><p>How many stock-quarters are there in the filtered dataframe and how many unique permnos?</p></li>
<li><p>Which day of the week is the most popular day for earnings announcements? What fraction of earnings announcements occur on this day? Hint: the weekday method of a datetime object returns 0 for Monday, 1 for Tuesday, etc.</p></li>
<li><p>For each permno, find the most popular day of the week for earnings announcements. For each permno, calculate the fraction of the announcements that are made on that day? What is the mean of this fraction across permnos?</p></li>
<li><p>Cut the dataframe into ‘above median’ and ‘below median’ based on the absolute value of date_diff. What is the mean of the fraction in the previous queston across permnos within each of the two groups?</p></li>
<li><p>For each permno, calculate the fraction of zeros for date_diff.</p></li>
<li><p>Filter the dataframe further to include only stock-quarters for which</p>
<ol type="a">
<li><p>the fraction of zeros for date_diff is less than 0.5</p></li>
<li><p>the fraction of announcements on the permno’s most popular day of the week is less than 0.9.</p></li>
</ol></li>
</ol>
<p>Post this dataframe to Canvas.</p>
<ol start="15" type="1">
<li>How many stock-quarters are in the newly filtered dataframe? How many unique permnos?</li>
</ol>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>